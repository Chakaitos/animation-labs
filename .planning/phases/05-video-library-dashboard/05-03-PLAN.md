---
phase: 05-video-library-dashboard
plan: 03
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - app/(protected)/dashboard/page.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard displays recent videos (up to 5)"
    - "Dashboard shows accurate video count for current month"
    - "Dashboard has View All link to /videos page"
    - "Empty state shows when user has no videos"
  artifacts:
    - path: "app/(protected)/dashboard/page.tsx"
      provides: "Enhanced dashboard with real video data"
      contains: ["order('created_at'", "limit(5)"]
  key_links:
    - from: "app/(protected)/dashboard/page.tsx"
      to: "supabase.from('videos')"
      via: "Fetch recent videos"
      pattern: "\\.from\\('videos'\\)"
    - from: "app/(protected)/dashboard/page.tsx"
      to: "/videos"
      via: "View All link"
      pattern: "href=\"/videos\""
    - from: "app/(protected)/dashboard/page.tsx"
      to: "components/videos/video-card.tsx"
      via: "VideoCard import"
      pattern: "VideoCard"
---

<objective>
Enhance dashboard to display real video data and accurate statistics.

Purpose: Replace placeholder "0" videos count and static empty state with actual data from the videos table. Shows 5 most recent videos with link to full library. This completes requirements DASH-02 (recent videos list) while DASH-01 (credit balance) and DASH-03 (Create Video button) are already implemented.

Output: Dashboard showing real recent videos, accurate video count, and proper empty state with View All navigation.
</objective>

<execution_context>
@/Users/chakaitos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chakaitos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-video-library-dashboard/05-CONTEXT.md
@.planning/phases/05-video-library-dashboard/05-01-SUMMARY.md
@app/(protected)/dashboard/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add video queries and display to dashboard</name>
  <files>app/(protected)/dashboard/page.tsx</files>
  <action>
Enhance the existing dashboard page to fetch and display real video data.

**1. Add imports at top of file:**

```typescript
import { VideoCard } from '@/components/videos/video-card'
import { EmptyVideosState } from '@/components/videos/empty-state'
```

**2. Add video queries after subscription query:**

```typescript
// Get recent videos (limit 5)
const { data: recentVideos } = await supabase
  .from('videos')
  .select('id, brand_name, status, video_url, thumbnail_url, created_at, error_message')
  .eq('user_id', user.id)
  .order('created_at', { ascending: false })
  .limit(5)

// Get video count for this month
const startOfMonth = new Date()
startOfMonth.setDate(1)
startOfMonth.setHours(0, 0, 0, 0)

const { count: videosThisMonth } = await supabase
  .from('videos')
  .select('*', { count: 'exact', head: true })
  .eq('user_id', user.id)
  .gte('created_at', startOfMonth.toISOString())
```

**3. Update "Videos Created" stat card:**

Find the card with "Videos Created" title and replace hardcoded "0":

```typescript
<Card>
  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
    <CardTitle className="text-sm font-medium">Videos Created</CardTitle>
    <Video className="h-4 w-4 text-muted-foreground" />
  </CardHeader>
  <CardContent>
    <div className="text-2xl font-bold">{videosThisMonth ?? 0}</div>
    <p className="text-xs text-muted-foreground">This month</p>
  </CardContent>
</Card>
```

**4. Replace Recent Videos section:**

Find the existing placeholder section (lines ~110-130) and replace with:

```typescript
{/* Recent Videos Section */}
{hasSubscription && (
  <div>
    <div className="flex justify-between items-center mb-4">
      <h2 className="text-lg font-semibold">Recent Videos</h2>
      {recentVideos && recentVideos.length > 0 && (
        <Button variant="ghost" asChild>
          <Link href="/videos">View All</Link>
        </Button>
      )}
    </div>

    {recentVideos && recentVideos.length > 0 ? (
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        {recentVideos.map((video) => (
          <VideoCard key={video.id} video={video} />
        ))}
      </div>
    ) : (
      <EmptyVideosState />
    )}
  </div>
)}
```

**5. Type safety note:**

The Supabase query returns the correct shape for VideoCard. If TypeScript complains, ensure the select fields match the Video type in video-card.tsx:
- id, brand_name, status, video_url, thumbnail_url, created_at, error_message
  </action>
  <verify>
- Dashboard page compiles without errors: `npm run build`
- VideoCard and EmptyVideosState imports resolve
- No TypeScript errors
  </verify>
  <done>Dashboard fetches and displays recent videos with accurate monthly count and View All navigation</done>
</task>

</tasks>

<verification>
All checks must pass:
1. `npm run build` completes without errors
2. Dashboard page imports VideoCard and EmptyVideosState successfully
3. Dashboard shows video count stat (may be 0 if no videos)
4. "View All" link points to /videos
</verification>

<success_criteria>
- Dashboard "Videos Created" card shows actual count for current month
- Recent Videos section shows up to 5 most recent videos
- Empty state shown when user has no videos (with Create Video CTA)
- "View All" link appears when videos exist, navigates to /videos
- All data fetched server-side in Server Component
</success_criteria>

<output>
After completion, create `.planning/phases/05-video-library-dashboard/05-03-SUMMARY.md`
</output>
