---
phase: 04-core-video-creation
plan: 05
type: execute
wave: 4
depends_on: ["04-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Complete video creation flow works end-to-end"
    - "User can upload logo and see extracted colors"
    - "User can fill out all form fields"
    - "User can review and submit order"
    - "Credits are deducted on submission"
    - "User is redirected to dashboard after submission"
    - "Video appears in dashboard with processing status"
  artifacts: []
  key_links: []
---

<objective>
Manually verify the complete video creation flow from upload to submission.

Purpose: Confirm all pieces work together before moving to next phase.
Output: Verification that the user can create videos through the platform.
</objective>

<execution_context>
@/Users/chakaitos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chakaitos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-core-video-creation/04-CONTEXT.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify complete video creation flow</name>
  <what-built>
Multi-step video creation form with:
- Logo upload (drag-and-drop + click)
- Automatic color extraction
- Brand name, duration, quality, style fields
- Creative direction textarea
- Review screen with all selections
- Submit that creates video record, deducts credits, triggers n8n webhook
- Redirect to dashboard after submission
  </what-built>
  <how-to-verify>
**Pre-requisites:**
1. User is logged in with at least 1 credit (subscribe if needed)
2. Supabase 'logos' storage bucket exists and is public
3. Migration 00003_storage_setup.sql has been applied
4. N8N_WEBHOOK_URL and N8N_WEBHOOK_SECRET are in .env.local (or leave empty to skip webhook)

**Test Steps:**

1. **Navigate to create video page**
   - Go to http://localhost:3000/create-video
   - Should see step indicator with "Upload Logo" as step 1
   - Header shows credit balance

2. **Test upload step**
   - Drag a JPG/PNG/WebP logo file onto the upload area
   - OR click the upload area and select a file
   - Should see:
     - File preview thumbnail
     - File name and size
     - Extracted primary and secondary colors with swatches
   - Click "Continue" to proceed

3. **Test details step**
   - Enter brand name (e.g., "Test Brand")
   - Select duration from dropdown (default: 15s)
   - Select quality from dropdown (default: 1080p)
   - Click "Continue" to proceed

4. **Test style step**
   - Select a style preset from dropdown (default: modern)
   - Optionally add creative direction text
   - If "custom" style selected, creative direction becomes prominent
   - Click "Continue" to proceed

5. **Test review step**
   - See summary of all selections:
     - Logo thumbnail
     - Extracted colors
     - Brand name
     - Duration
     - Quality
     - Style
     - Creative direction (if entered)
   - See credit cost notice (1 credit)
   - Click "Create Video" button

6. **Verify submission**
   - Button shows "Creating Video..." loading state
   - After completion:
     - Toast notification: "Video creation started!"
     - Redirected to /dashboard

7. **Verify dashboard state**
   - Credit balance reduced by 1
   - (Future: Video appears in "Recent Videos" with status "processing")

8. **Verify database records** (Supabase Dashboard)
   - Check `videos` table:
     - New row with correct brand_name, duration_seconds, quality, style
     - status = 'processing'
     - logo_url points to uploaded file
     - primary_color and secondary_color are set
   - Check `credit_transactions` table:
     - New row with type = 'usage', amount = -1

9. **Test edge cases**
   - Try uploading a non-image file (should be rejected)
   - Try uploading a file > 25MB (should be rejected)
   - Try submitting with empty brand name (validation should block)

**Known Limitations:**
- n8n webhook may not be configured (video will stay in 'processing')
- Video library display is Phase 5 (video won't show in dashboard yet)
  </how-to-verify>
  <resume-signal>
Type "approved" if the flow works correctly.
Type "issues: [description]" to report problems.
  </resume-signal>
</task>

</tasks>

<verification>
Human verification of:
- Upload with color extraction works
- Form fields validate correctly
- Review displays all data
- Submission deducts credits and creates video record
- Redirect to dashboard works
</verification>

<success_criteria>
- Complete flow from upload to dashboard redirect works
- Credits are deducted correctly
- Video record is created with correct data
- Logo file is uploaded to Supabase Storage
- No console errors during the flow
</success_criteria>

<output>
After completion, create `.planning/phases/04-core-video-creation/04-05-SUMMARY.md`
</output>
